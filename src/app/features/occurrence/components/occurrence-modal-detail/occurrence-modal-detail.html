@if (occurrence(); as o) {
  <article class="p-4 min-w-[280px] max-w-[90vw]">
    <header class="flex items-center justify-between gap-4 mb-2">
      <h3 class="m-0 text-lg">Occurrence #{{ o.id }}</h3>
      <button
        aria-label="Fermer"
        class="bg-transparent border-0 text-xl"
        type="button"
        (click)="onClose()()"
      >
        ×
      </button>
    </header>

    <section class="space-y-1">
      @if (o.taxon?.scientific_name) {
        <p>Nom scientifique: {{ o.taxon!.scientific_name }}</p>
      }
      @if (o.taxon?.taxon_repository) {
        <p>Référentiel: {{ o.taxon!.taxon_repository }}</p>
      }
      @if (o.taxon?.vernacular_names?.length) {
        <p>Noms vernaculaires: {{ o.taxon!.vernacular_names!.join(', ') }}</p>
      }

      <div class="w-40 h-40 relative">
        <img
          fill
          priority
          [alt]="imageAlt()"
          [ngSrc]="imageSrc()"
          [title]="imageTitle()"
        />
      </div>

      @if (!o.card_tag) {
        <p>Pas de fiche</p>
      }

      @if (o.anecdotes) {
        <p>{{ o.anecdotes }}</p>
      }

      @if (sharedService.canEditTrail(
        userService.user(),
        sentier(),
        userService.isUserAdmin()
      )) {
        <button class="" title="modifier l'individu" type="button" (click)="openOccurrenceForm()">Modifier</button>
        <button class="bg-red-800 hover:bg-red-600 text-white" title="supprimer l'individu" type="button" (click)="openDeleteConfirmation()">Supprimer</button>
      }

    </section>
  </article>

  @if (showOccurrenceForm) {
    <app-occurrence-form
      [occurrence]="occurrence()"
      [position]="o.position!"
      [sentier]="o.sentier!"
      (modalClosed)="closeOccurrenceForm()"
      (modalSuccessed)="occurrenceUpdateSuccessed()"
    />
  }

  @if (showDeleteConfirmModal) {
    <app-modal-delete-trail-confirmation
      [occurrenceToDelete]="occurrence()"
      [type]="'occurrence'"
      (modalClosed)="closeDeleteConfirmModal()"
      (modalSucceed)="deleteOccurrence()"
    />
  }
}
